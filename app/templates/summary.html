{% extends '_base.html' %}
{% block content %}

<div class="row">
  <div class="col">
    <p class="lead mt-5 text-start">Hello, <b>{{ current_user.username }}</b>!</p>
  </div>
  <div class="col">
    <p class="lead mt-5 text-end">
      <a href="{{ url_for('diary.new_dance_entry') }}" class="btn btn-sm btn-info fw-bold text-white">
        {% include 'icons/upload.html' %} Upload New</a>
      {% if video_posts %}
      <a href="{{ url_for('diary.all_dance_summary') }}" class="btn btn-sm btn-primary fw-bold text-white">
        {% include 'icons/barchart.html' %} Dance Summary </a>
      {% endif %}
    </p>
  </div>

</div>

<hr />
<p class="lead mt-5 text-start">In total, you have uploaded {{ video_posts | length }} choreographies</p>
<div class="row">
  <div class="col-4">
    <div class="card mb-2 rounded-3 shadow-sm">
      <div class="card-body">
        <small>Total Duration</small>
        <h1 class="card-title pricing-card-title">{{ total_duration | round(2) }}</h1>
      </div>
    </div>
  </div>
  <div class="col-4">
    <div class="card mb-2 rounded-3 shadow-sm">
      <div class="card-body">
        <small>Total Spins</small>
        <h1 class="card-title pricing-card-title">{{ total_spins }}</h1>
      </div>
    </div>
  </div>
  <div class="col-4">
    <div class="card mb-2 rounded-3 shadow-sm">
      <div class="card-body">
        <small>Total Inversions</small>
        <h1 class="card-title pricing-card-title">{{ total_inversions }}</h1>
      </div>
    </div>
  </div>


  <div class="col-12 mb-3">
    <div style="border: 1px solid silver; border-radius: 15px; overflow: hidden;">
      <div id="fig_body"></div>
    </div>
    
  </div>

  <div class="col-12 mb-3">
    <div style="border: 1px solid silver; border-radius: 15px; overflow: hidden;">
      <div id="fig_tricks"></div>
    </div>
    
  </div>

  <div class="col-12 mb-3">
    <div style="border: 1px solid silver; border-radius: 15px; overflow: hidden;">
      <div id="fig_rom"></div>
    </div>
    
  </div>

  <script>
    var fig_body = {{ fig_body | safe }};
    var fig_tricks = {{ fig_tricks | safe }};
    var fig_rom = {{ fig_rom | safe }};

    Plotly.newPlot('fig_body', fig_body.data, fig_body.layout);
    Plotly.newPlot('fig_tricks', fig_tricks.data, fig_tricks.layout);
    Plotly.newPlot('fig_rom', fig_rom.data, fig_rom.layout);
  </script>
<div class="col-12">

  {% if video_posts %}
  <div class="table-responsive small">
    <table class="table table-striped table-sm text-start" style="font-size: small;">
      <thead>
        <tr>
          <th>Last Updated On</th>
          <th>Title</th>
          <th>Duration</th>
          <th>Reporting</th>

        </tr>
      </thead>
      <tbody>
        {% for post in video_posts %}
        <tr>
          <td>{{ post.last_updated_on }}</td>
          <td>{{ post.title | capitalize() }}</td>
          <td>{{ post.duration | round(2) }}</td>
          <td>
            <a href="{{ url_for('reports.overview', id=post.id) }}">View Report</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}


</div>
</div>

{% endblock %}